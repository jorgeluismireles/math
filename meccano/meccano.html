<!DOCTYPE html>
<html>
<head>
<title>Meccano</title>
<style>
td { vertical-align:top; }
</style>
</head>
<body>
<h1>Meccano regular heptagon</h1>

<h2>Theory</h2>
<table>
<tr>
<td>
<object data="automatic/heptagon_construction_js.svg" type="image/svg+xml"></object>
</td>
<td>
<pre>
Heptagonal triangles:
    A = 1*pi/7
    B = 2*pi/7
    C = 3*pi/7
    
Heptagonal sides:
        _____   _____   _____
    a = p6 q1 = p1 p7 = p6 p7

Heptagonal sines:
            _____   _____   _____
    sin A = q4 p6 / p6 q1 = q4 p6 / a
            _____   _____   _____
    sin B = q2 p1 / p1 p7 = q2 p1 / a
            _____   _____   _____
    sin C = q3 p6 / p6 p7 = q3 p6 / a

Finding heptagonal internal height:
    _____   _____   _____   _____
    r1 q1 = p1 q2 + q3 p6 - p6 q4
          = a * (sin B + sin C - sin A)

According <a href="https://en.wikipedia.org/wiki/Heptagonal_triangle">heptagonal triangles</a>, we know:

    sin A - sin B - sin C = - sqrt(7)/2

So:
   _____   
   r1 q1 = a * sqrt(7) / 2

Then (orange):
   _____         _____2   _____2  
   q1 r2 = sqrt( r1 r2  + r1 q1 )
                 _____2
         = sqrt( r1 r2  + 7*a*a / 4)
</pre>
</td>
</tr>

<tr>
<td>
<svg width="440" height="440" style="border:1px solid gray;">
 <g id="heptagon1" transform="translate(250 250)">
  <g fill="#08f8" stroke="#008">
   <path id="p8a"></path>
   <path id="p8b"></path>
   <path id="p8c"></path>
   <path id="p8d"></path>
   <path id="p8e"></path>
   <path id="p8f"></path>
   <path id="p8g"></path>

   <path id="p8h"></path>
   <path id="p8i"></path>
   <path id="p8j"></path>
   <path id="p8k"></path>
  </g>
  <g fill="#f808" stroke="#800">
   <path id="p8l"></path>
   <path id="p8m"></path>
   <path id="p8n"></path>
   <path id="p8o"></path>
  </g>
 </g>
</svg>
</td>

<td>
<pre>
             _____
Do a = 8 and r1 r2 = 3, and get 't Hooft heptagon:
   _____
   q1 r2 = sqrt( 9 + 7*64 / 4)
         = 11
</pre>
</td>
</tr>

<tr>
<td>
<svg xmlns="http://www.w3.org/2000/svg" width="340" height="340">
 <g id="heptagon2">
  <g fill="#08f" fill-opacity="0.5" stroke="#008">
   <path id="p3a"></path>
   <path id="p3b"></path>
   <path id="p3c"></path>
   <path id="p3d"></path>
   <path id="p3e"></path>
   <path id="p3f"></path>
   <path id="p3g"></path>

   <path id="p3h"></path>
   <path id="p3i"></path>
   <path id="p3j"></path>
   <path id="p3k"></path>
  </g>
  <g fill="#f80" fill-opacity="0.5" stroke="#800">
   <path id="p4a"></path>
   <path id="p4b"></path>
   <path id="p4c"></path>
   <path id="p4d"></path>
  </g>
 </g>
</svg>
</td>
<td>
<pre>
One smaller rational heptagon!
             _____
Do a = 3 and r1 r2 = 1/2
   _____
   q1 r2 = sqrt( 1/4 + 7*9 / 4))
         = 4
</pre>
</td>
</tr>
</table>
</body>


<script type="text/javascript">
const rod = (R, n, skip)=> {
	const r = R/2
	const L = 2 * n * r
	const d  = [ 
		"m", -r, 0,
		"a", r, r, 0, 0, 1, +2*r, 0, "l", 0, +L,
		"a", r, r, 0, 0, 1, -2*r, 0, "l", 0, -L,
		"z", "m", r/2, -2*r
	]	
	for (let i=0; i <= n; i++) { // holes
    d.push(...["m", 0, 2*r])
    if (skip && (i % 2 == 1))
      continue
		d.push(...["a", r/2, r/2, 0, 0, 0, r, 0, r/2, r/2, 0, 0, 0, -r, 0])
	}
	return d.join(" ")
}

const r = 20
const R = (r)=> { return `rotate(${r})`}

const dt = (id, d, t)=> {
	if (d) document.getElementById(id).setAttribute("d", d);
	if (t) document.getElementById(id).setAttribute("transform", t) 	
}

{
  const r8  = ()=> { return rod(r, 8) }
  const r11 = ()=> { return rod(r, 11) }
  const t8 = `translate(0 ${8*r})`

  const r0 = 90 - 180/7
  const r1 = 2 * 180/7
  dt("heptagon1", null, "translate(220,40) scale(1 1)")
  dt("p8a", r8(), `${R(+r0)}`)
  dt("p8b", r8(), `${R(-r0)}`)
  dt("p8c", r8(), `${R(+r0)} ${t8} ${R(-r1)}`)
  dt("p8d", r8(), `${R(-r0)} ${t8} ${R(+r1)}`)
  dt("p8e", r8(), `${R(+r0)} ${t8} ${R(-r1)} ${t8} ${R(-r1)}`)
  dt("p8f", r8(), `${R(-r0)} ${t8} ${R(+r1)} ${t8} ${R(+r1)}`)
  dt("p8g", r8(), `${R(+r0)} ${t8} ${R(-r1)} ${t8} ${R(-r1)} ${t8} ${R(-r1)}`)

  const r2 = 90 -3*180/7

  dt("p8h", r8(), `${R(+r2)}`)
  dt("p8i", r8(), `${R(-r2)}`)
  dt("p8j", r8(), `${R(+r2)} ${t8} ${R(+r1)}`)
  dt("p8k", r8(), `${R(-r2)} ${t8} ${R(-r1)}`)

  const t1 = `translate(0 ${1*r})`
  const t7 = `translate(0 ${7*r})`

  dt("p8l", r11(), `${R(+r0)} ${t8} ${R(-r1)} ${t8} ${R(-r1)} ${t1} ${R(-74.1)}`)
  dt("p8m", r11(), `${R(+r0)} ${t8} ${R(-r1)} ${t8} ${R(-r1)} ${t7} ${R(-105.7)}`)

  dt("p8n", r11(), `${R(-r0)} ${t8} ${R(+r1)} ${t8} ${R(+r1)} ${t1} ${R(+74.1)}`)
  dt("p8o", r11(), `${R(-r0)} ${t8} ${R(+r1)} ${t8} ${R(+r1)} ${t7} ${R(+105.7)}`)
}

{
  const r = 20
  const r3 = ()=> { return rod(r, 6, true) }
  const r4 = ()=> { return rod(r, 8, true) }

  const t1 = `translate(0 ${2*r})`
  const t2 = `translate(0 ${4*r})`
  const t3 = `translate(0 ${6*r})`

  const r0 = 90 - 180/7
  const r1 = 2 * 180/7
  dt("heptagon2", null, "translate(170,40) scale(1 1)")
  dt("p3a", r3(), `${R(+r0)}`)
  dt("p3b", r3(), `${R(-r0)}`)
  dt("p3c", r3(), `${R(+r0)} ${t3} ${R(-r1)}`)
  dt("p3d", r3(), `${R(-r0)} ${t3} ${R(+r1)}`)
  dt("p3e", r3(), `${R(+r0)} ${t3} ${R(-r1)} ${t3} ${R(-r1)}`)
  dt("p3f", r3(), `${R(-r0)} ${t3} ${R(+r1)} ${t3} ${R(+r1)}`)
  dt("p3g", r3(), `${R(+r0)} ${t3} ${R(-r1)} ${t3} ${R(-r1)} ${t3} ${R(-r1)}`)

  const r2 = 90 -3*180/7

  dt("p3h", r3(), `${R(+r2)}`)
  dt("p3i", r3(), `${R(-r2)}`)
  dt("p3j", r3(), `${R(+r2)} ${t3} ${R(+r1)}`)
  dt("p3k", r3(), `${R(-r2)} ${t3} ${R(-r1)}`)

  dt("p4a", r4(), `${R(+r0)} ${t3} ${R(-r1)} ${t3} ${R(-r1)} ${t1} ${R(-82.90)}`)
  dt("p4b", r4(), `${R(+r0)} ${t3} ${R(-r1)} ${t3} ${R(-r1)} ${t2} ${R(-97.17)}`)

  dt("p4c", r4(), `${R(-r0)} ${t3} ${R(+r1)} ${t3} ${R(+r1)} ${t1} ${R(+82.90)}`)
  dt("p4d", r4(), `${R(-r0)} ${t3} ${R(+r1)} ${t3} ${R(+r1)} ${t2} ${R(+97.17)}`)
}

/*



const H = 180/7
const Hr = Math.PI*H/180
const a = 1
const b = 8
const d = b*Math.sqrt(2 - 2*Math.cos(Hr))
const e = Math.sqrt(a*a + d*d - 2*a*d*Math.cos(2*Hr))
const E = Math.acos((e*e + a*a - d*d) / (2*e*a))
const F = (11*Hr) - E
const c = Math.sqrt(e*e + b*b - 2*e*b*Math.cos(F))
const C = Math.acos((b*b + c*c - e*e) / (2*b*c))


const sin = (s)=> { return Math.sin(s*Math.PI/7) }

const y1 = 8*Math.sin(2*Math.PI / 7)

document.getElementById("pre").innerHTML =
`
  sin(1*pi/7) = ${sin(1)}
  sin(2*pi/7) = ${sin(2)}
  sin(3*pi/7) = ${sin(3)} = sin(4*pi/7)
  sin(4*pi/7) = ${sin(4)}

  sin2 / sin1 = ${ sin(2) / sin(1) } = diagonal-b
  sin3 / sin1 = ${ sin(3) / sin(1) } = diagonal-c
  sin3 / sin2 = ${ sin(3) / sin(2) } = 1 - diagonal-c

- sin(pi/7) + sin(2pi/7) + sin(4pi/7) = [${- sin(1) + sin(2) + sin(4) }]
                        sqrt(112) / 8 = [${ Math.sqrt(112) / 8 }]



  H = pi/7    = [${H}°]
  A = 2H      = [${2*H}°]
  B = 11H     = [${11*H}°]
C+D = 2pi-A-B = H 

  a =                                   [${a}]
  b =                                   [${b}]
  d = b*sqrt(2-2cosH)                 = [${d}]
  e = sqrt(a*a + d*d - 2*a*d*cos(A))  = [${e}]

  E = acos((e*e + a*a - d*d) / 2*e*a) = [${180*E / Math.PI}°]
  F = B - E                           = [${180*F / Math.PI}°]

  c = sqrt(e*e + b*b - 2*e*b*cos(F))  = [${c}]

  C = acos((b*b + c*c - e*e) / 2*b*c) = [${180*C / Math.PI}°]
`

const funct = (a)=> { return 2*a*a - a + 1 }

for (let i=0; i < 16; i+=1)
  console.log(`i=${i} funct=${funct(i)}`)
*/
</script>
</html>